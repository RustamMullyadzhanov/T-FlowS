!======================================================================!
  REAL FUNCTION Atanh(x)
!----------------------------------------------------------------------!
!   Calculates inverse of hyperbolic tangens.                          !
!----------------------------------------------------------------------!
  IMPLICIT NONE
!-----------------------------[Parameters]-----------------------------!
  REAL :: x
!======================================================================!
  if(x  > 1.0) then
    write(*,*) 'Error message from atanh: bad argument'
    stop
  end if 

  atanh=log( sqrt( (1.0+x)/(1.0-x) ) )

  END FUNCTION Atanh
